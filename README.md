# Adapted-SRGAN
## High-resolution aeromagnetic map through Adapted-SRGAN (ASRGAN)
This is an adapted version of SRGAN called Adapted-SRGAN (ASRGAN). Original code from :  [https://github.com/tensorlayer/srgan](https://github.com/tensorlayer/srgan)

An interface associated to application of the code to aeromagnetic map is available on [Google Coab](https://drive.google.com/drive/u/0/folders/1ndGctneBDqkJS9jCtnVRyxuz6paRqpJt). The SRGAN and ASRGAN model was built on the TensorFlow platform and trained on Google CoLab Pro with 32 GB of RAM.

## Requirements
- Python 3.8 
- tensorlayer>=2.0.0
- imgaug>=0.2.5
- h5py==2.10.0
- For GPU supprot (see [tensorflow GPU](https://www.tensorflow.org/install/source_windows)): 
  - tensorflow-gpu==2.0.0
  - CUDA 10.1
  - cuDNN 7.4

## Test
### To see the super resolution models (SRGAN and ASRGAN) results and quantitative metrics
- Clone the repository
- Download training and test set from [Google Drive](https://drive.google.com/drive/folders/1hzaHhKxECOFS1vNARse_DrKMfpc3sNCf?usp=sharing)
- Download our pre-trained models for SRGAN and Adapted-SRGAN (ASRGAN) from the links below, and place them to ./models.

| Models                  | Links         |
| -------------           | ------------- |
| SRGAN                   | [Google Drive SRGAN](https://drive.google.com/file/d/1_xZf7W3DUtJ_9rxA62q3AuIK6NOPg-ZX/view?usp=sharing)  |
| Adapted-SRGAN (ASRGAN)  |[Google Drive ASRGAN](https://drive.google.com/file/d/1v0SmSOsQ9Kd7LAHkyB508yJG8oHcnad0/view?usp=sharing) |

- Open the [evaluation.ipynb](https://colab.research.google.com/drive/1-YiFiTdv2_n8syGiy3FhRYBXJWK24Mdb?usp=sharing) in Google Colab. 
-  Change all the paths for the training set, test set, and model to your corresponding directory in google drive.
## Training
### For training the super resolution model
- Change all the paths in [config.py](https://drive.google.com/file/d/1dV2zpO6blN3VUaKg3ObXD2srrcvfl5jl/view?usp=sharing) and [train.py](https://drive.google.com/file/d/1nqXHYLPFK3wLzVPDs2OEXkId6esa6Pwp/view?usp=sharing) to your local path. 
- Training the model based on SRGAN or ASRGAN using [run_me.ipynb](https://colab.research.google.com/drive/1Ituw1Mq8AewthavfioC57LD0WlYRdaM9?usp=sharing) in Google Colab.

## Adapted-SRGAN network architecture
<img src="https://github.com/MBS1984/Adapted-SRGAN/blob/main/images/ASRGAN_network.png" width=90% height=50%>

## High and low resolution aeromagnetic counterparts 
<img src="https://github.com/MBS1984/Adapted-SRGAN/blob/main/images/High_low_counterparts.PNG" width=80% height=50%>

## Results
Examples of generated aeromagnetic maps in training set: From the left LR, HR and ASRGAN images

<img src="https://github.com/MBS1984/Adapted-SRGAN/blob/main/images/Result_training_set.png" width=80% height=50%>

Example of generated aeromagnetic maps in test set using different methods (a) low-resolution map (b) high-resolution map (c) map generated by bicubic interpolation (d) map generated by SRGAN (d) map generated by ASRGAN.

<img src="https://github.com/MBS1984/Adapted-SRGAN/blob/main/images/Result_validation_set.png" width=80% height=50%>

### Cross plot and R-squared between high, low and generated aeromagnetic map


<img src="https://github.com/MBS1984/Adapted-SRGAN/blob/main/images/crossplot.PNG" width=60% height=40%>

### Quantitative results
Average and Maximum PSNR/SSIM values for bicubic interpolation, SRGAN and Adapted-SRGAN(SRGAN) models
<img src="https://github.com/MBS1984/Adapted-SRGAN/blob/main/images/Quantitative%20results.PNG" width=80% height=50%>
